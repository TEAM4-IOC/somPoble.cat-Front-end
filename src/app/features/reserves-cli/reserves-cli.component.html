<div *ngIf="serviceData; else loading">
    <h2>Gestión de reserva para el servicio: </h2>

    <!-- Detalls del servei -->
    <div class="service-details">
        <p><strong>Nom:</strong> {{ serviceData.nombre }}</p>
        <p>El resto de datos solo están pruestos para pruebas</p>
        <p>Para verificar que lo que muestra el calendario es coherente con los días y horarios</p>
        <p>se eliminarán</p>
        <p><strong>Descripció:</strong> {{ serviceData.descripcion }}</p>
        <p><strong>Límit de Reserves:</strong> {{ serviceData.limiteReservas }}</p>
        <p><strong>Horari:</strong> {{ serviceData.horarioInicio }} - {{ serviceData.horarioFin }}</p>
        <p><strong>Dies Laborables:</strong> {{ serviceData.diasLaborables }}</p>
    </div>

    <!-- Formulari de reserva -->
    <form [formGroup]="reservaForm" (ngSubmit)="createReserva()">
        <div>
            <label for="fechaReserva">Selecciona un dia:</label>
            <!-- Nou calendari -->
            <div class="calendar">
                <div class="calendar-header">
                    <button type="button" (click)="prevMonth()">&#8592;</button>
                    <span>{{ currentMonthName }} {{ currentYear }}</span>
                    <button type="button" (click)="nextMonth()">&#8594;</button>
                </div>
                <div class="calendar-grid">
                    <div
                        *ngFor="let day of daysInMonth"
                        [class.available]="day.isAvailable"
                        [class.unavailable]="!day.isAvailable && day.date && !day.isPast"
                        [class.past]="day.isPast"
                        [class.selected]="isSelected(day.date)"
                        [class.empty]="!day.date"
                        (click)="selectDate(day)"
                    >
                        {{ day.date?.getDate() }}
                    </div>
                </div>
            </div>
            <p *ngIf="!isLaborableDay" class="error-message">
                El dia seleccionat no és laborable per a aquest servei.
            </p>
        </div>

        <div>
            <label for="hora">Selecciona una hora:</label>
            <select id="hora" formControlName="hora">
                <option *ngFor="let hour of availableHours" [value]="hour">{{ hour }}</option>
            </select>
        </div>

        <button type="submit" [disabled]="reservaForm.invalid">Crear Reserva</button>
    </form>
</div>

<ng-template #loading>
    <p>Carregant dades del servei...</p>
</ng-template>