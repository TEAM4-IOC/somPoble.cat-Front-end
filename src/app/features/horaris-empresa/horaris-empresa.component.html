<div class="d-flex justify-content-center mb-3">
  <button
    class="btn me-2"
    [ngClass]="{ 'btn-primary': isMonthlyView, 'btn-secondary': !isMonthlyView }"
    (click)="toggleView()"
    [disabled]="isMonthlyView">
    Vista Mensual
  </button>
  <button
    class="btn"
    [ngClass]="{ 'btn-primary': !isMonthlyView, 'btn-secondary': isMonthlyView }"
    (click)="toggleView()"
    [disabled]="!isMonthlyView">
    Vista Diària
  </button>
</div>

<!-- Vista mensual -->
<div *ngIf="isMonthlyView">
  <div class="calendar-container">
    <div class="calendar-header">
      <button class="nav-button" (click)="prevMonth()">&#8592;</button>
      <h2 class="calendar-title">{{ currentMonthName }} {{ currentYear }}</h2>
      <button class="nav-button" (click)="nextMonth()">&#8594;</button>
    </div>
    <div class="calendar-content">
      <!-- Calendario -->
      <div class="month-grid">
        <!-- Encabezados de los días de la semana -->
        <div class="day-header" *ngFor="let day of weekDays">{{ day }}</div>
        <!-- Días del mes -->
        <div
  class="day-cell"
  *ngFor="let day of daysInMonth"
  [class.disabled]="!day.isCurrentMonth"
  [class.past-day]="isPastDay(day.date, day.isCurrentMonth)"
  (click)="goToDailyView(day)"
>
  <div class="day-number">{{ day.date }}</div>
  <div class="service-bars">
    <!-- Mostrar una barra de color por cada servicio disponible en el día -->
    <div
      *ngFor="let servicio of getServicesForDay(day.date)"
      class="service-bar"
      [style.backgroundColor]="getServiceColor(servicio)"
    ></div>
  </div>
</div>
      </div>

      <!-- Leyenda -->
      <div class="legend">
        <h3>Servicios</h3>
        <ul>
          <li *ngFor="let servicio of servicios">
            <span
              class="legend-color"
              [style.backgroundColor]="getServiceColor(servicio)"
            ></span>
            {{ servicio.nombre }}
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- Vista diaria -->
<div *ngIf="!isMonthlyView">
  <div class="calendar-container">
    <div class="calendar-header">
      <button class="nav-button" (click)="prevDay()">&#8592;</button>
      <h2 class="calendar-title">{{ currentDayName }}, {{ currentDay }} {{ currentMonthName }} {{ currentYear }}</h2>
      <button class="nav-button" (click)="nextDay()">&#8594;</button>
    </div>
    <div class="agenda-grid">
      <!-- Horas del día -->
      <div class="hour-row" *ngFor="let hour of getHours()">
        <div class="hour-label">
          <!-- Dividir las horas en dos líneas -->
          <span>{{ hour.split(' ')[0] }}</span><br />
          <span>{{ hour.split(' ')[1] }}</span>
        </div>
        <div class="hour-cell">
          <!-- Mostrar los servicios disponibles en esta hora -->
          <div *ngFor="let servicio of servicios">
            <div
              *ngIf="isServiceAvailable(servicio, hour)"
              class="service-block"
              [style.backgroundColor]="getServiceColor(servicio)"
            >
              <strong>{{ servicio.nombre }}</strong>

              <!-- Mostrar reservas -->
              <div class="reservas" *ngIf="getReservasForServiceAndHour(servicio.idServicio, hour).length > 0; else noReservas">
                <h5>Reserves:</h5>
                <div *ngFor="let reserva of getReservasForServiceAndHour(servicio.idServicio, hour)">
                  <span>ID: {{ reserva.id }} - Estat: {{ reserva.estado }} - DNI: {{ reserva.dniCliente }}</span>
                </div>
              </div>
              <!-- Missatge quan no hi ha reserves -->
              <ng-template #noReservas>
                <span class="no-reservas">Sense reserves</span>
              </ng-template>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>